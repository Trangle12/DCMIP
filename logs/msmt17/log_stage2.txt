==========
Args:Namespace(dataset='msmt17', batch_size=256, workers=4, height=320, width=128, num_instances=16, eps=0.7, eps_gap=0.02, k1=30, k2=6, arch='resnet50', features=0, dropout=0, momentum=0.1, memorybank='CMhybrid', smooth=0, lr=0.00035, weight_decay=0.0005, epochs_stage1=40, epochs_stage2=50, iters_stage1=100, iters_stage2=100, step_size=20, seed=1, print_freq=100, eval_step=10, temp=0.05, data_dir='/data/tx/DCMIP/PCLHD-CCL/examples/data', logs_dir='../logs/msmt17/v3', pooling_type='gem', use_hard=False, no_cam=False)
==========
==> Load unlabeled dataset
=> MSMT17_V1 loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |  1041 |    32621 |        15
  query    |  3060 |    11659 |        15
  gallery  |  3060 |    82161 |        15
  ----------------------------------------
=> Loaded checkpoint '../logs/msmt17/v3/model_best_stage1.pth.tar'
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 34.2983558177948
Clustering criterion: eps: 0.700
==> Statistics for epoch 0: 999 clusters
Epoch: [0][100/100]	Time 0.257 (0.269)	Data 0.000 (0.023)	Loss cc 2.474 (1.584)	Loss ema 8.062 (6.353)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 34.73578143119812
==> Statistics for epoch 1: 910 clusters
Epoch: [1][100/100]	Time 0.209 (0.238)	Data 0.000 (0.026)	Loss cc 1.863 (1.572)	Loss ema 7.327 (6.020)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 33.009114027023315
==> Statistics for epoch 2: 950 clusters
Epoch: [2][100/100]	Time 0.219 (0.246)	Data 0.000 (0.023)	Loss cc 2.516 (1.610)	Loss ema 8.097 (5.906)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 37.54065942764282
==> Statistics for epoch 3: 979 clusters
Epoch: [3][100/100]	Time 0.194 (0.273)	Data 0.000 (0.022)	Loss cc 2.482 (1.439)	Loss ema 8.026 (5.703)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 35.04837656021118
==> Statistics for epoch 4: 958 clusters
Epoch: [4][100/100]	Time 0.285 (0.286)	Data 0.000 (0.023)	Loss cc 1.717 (1.365)	Loss ema 7.429 (5.613)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 32.26498365402222
==> Statistics for epoch 5: 984 clusters
Epoch: [5][100/100]	Time 0.202 (0.271)	Data 0.000 (0.022)	Loss cc 1.826 (1.455)	Loss ema 7.776 (5.537)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 35.09008264541626
==> Statistics for epoch 6: 977 clusters
Epoch: [6][100/100]	Time 0.270 (0.271)	Data 0.000 (0.024)	Loss cc 2.007 (1.325)	Loss ema 7.473 (5.574)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 32.54619812965393
==> Statistics for epoch 7: 996 clusters
Epoch: [7][100/100]	Time 0.210 (0.269)	Data 0.000 (0.024)	Loss cc 2.244 (1.289)	Loss ema 7.498 (5.505)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 32.353694915771484
==> Statistics for epoch 8: 953 clusters
Epoch: [8][100/100]	Time 0.269 (0.234)	Data 0.000 (0.019)	Loss cc 1.933 (1.353)	Loss ema 7.070 (5.490)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 38.07149815559387
==> Statistics for epoch 9: 1013 clusters
Epoch: [9][100/100]	Time 0.236 (0.236)	Data 0.000 (0.023)	Loss cc 2.088 (1.310)	Loss ema 7.259 (5.390)
Mean AP: 27.0%
Mean AP: 37.1%

 * Finished epoch   9  model mAP: 27.0%  model_ema mAP: 37.1%  best: 37.1% *

==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 36.62307953834534
==> Statistics for epoch 10: 1012 clusters
Epoch: [10][100/100]	Time 0.252 (0.272)	Data 0.000 (0.024)	Loss cc 1.329 (1.306)	Loss ema 6.634 (5.309)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 33.9126877784729
==> Statistics for epoch 11: 979 clusters
Epoch: [11][100/100]	Time 0.239 (0.273)	Data 0.000 (0.024)	Loss cc 1.737 (1.240)	Loss ema 7.082 (5.115)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 37.53531813621521
==> Statistics for epoch 12: 975 clusters
Epoch: [12][100/100]	Time 0.268 (0.269)	Data 0.000 (0.023)	Loss cc 1.826 (1.210)	Loss ema 7.213 (5.299)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 34.36311078071594
==> Statistics for epoch 13: 974 clusters
Epoch: [13][100/100]	Time 0.282 (0.253)	Data 0.000 (0.021)	Loss cc 1.690 (1.211)	Loss ema 6.735 (5.232)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 33.71757698059082
==> Statistics for epoch 14: 980 clusters
Epoch: [14][100/100]	Time 0.286 (0.236)	Data 0.000 (0.023)	Loss cc 1.731 (1.174)	Loss ema 6.778 (5.145)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 33.61030101776123
==> Statistics for epoch 15: 1023 clusters
Epoch: [15][100/100]	Time 0.191 (0.239)	Data 0.000 (0.022)	Loss cc 2.292 (1.262)	Loss ema 7.525 (5.085)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 36.4704110622406
==> Statistics for epoch 16: 1032 clusters
Epoch: [16][100/100]	Time 0.239 (0.258)	Data 0.000 (0.022)	Loss cc 2.640 (1.189)	Loss ema 7.421 (5.076)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 37.578681230545044
==> Statistics for epoch 17: 967 clusters
Epoch: [17][100/100]	Time 0.219 (0.281)	Data 0.000 (0.021)	Loss cc 1.572 (1.134)	Loss ema 6.976 (5.023)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 37.066033124923706
==> Statistics for epoch 18: 936 clusters
Epoch: [18][100/100]	Time 0.216 (0.285)	Data 0.000 (0.024)	Loss cc 1.468 (1.146)	Loss ema 6.334 (5.007)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 34.27176904678345
==> Statistics for epoch 19: 1024 clusters
Epoch: [19][100/100]	Time 0.259 (0.287)	Data 0.000 (0.024)	Loss cc 1.715 (1.117)	Loss ema 7.072 (4.960)
Mean AP: 27.6%
Mean AP: 39.1%

 * Finished epoch  19  model mAP: 27.6%  model_ema mAP: 39.1%  best: 39.1% *

==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 33.28216600418091
==> Statistics for epoch 20: 1016 clusters
Epoch: [20][100/100]	Time 0.264 (0.284)	Data 0.000 (0.027)	Loss cc 1.139 (0.963)	Loss ema 6.731 (4.898)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 36.567641258239746
==> Statistics for epoch 21: 1040 clusters
Epoch: [21][100/100]	Time 0.270 (0.270)	Data 0.000 (0.023)	Loss cc 1.072 (0.876)	Loss ema 6.267 (4.812)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 37.31355905532837
==> Statistics for epoch 22: 1059 clusters
Epoch: [22][100/100]	Time 0.240 (0.269)	Data 0.000 (0.024)	Loss cc 1.717 (0.847)	Loss ema 7.259 (4.720)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 32.46522092819214
==> Statistics for epoch 23: 1027 clusters
Epoch: [23][100/100]	Time 0.209 (0.262)	Data 0.000 (0.023)	Loss cc 1.857 (0.837)	Loss ema 7.819 (4.705)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 33.10834836959839
==> Statistics for epoch 24: 1048 clusters
Epoch: [24][100/100]	Time 0.213 (0.237)	Data 0.000 (0.024)	Loss cc 1.470 (0.808)	Loss ema 6.257 (4.560)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 35.49634504318237
==> Statistics for epoch 25: 1069 clusters
Epoch: [25][100/100]	Time 0.237 (0.261)	Data 0.000 (0.026)	Loss cc 1.124 (0.790)	Loss ema 6.855 (4.516)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 31.860973119735718
==> Statistics for epoch 26: 1075 clusters
Epoch: [26][100/100]	Time 0.205 (0.255)	Data 0.000 (0.025)	Loss cc 1.679 (0.792)	Loss ema 7.130 (4.516)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 31.43771529197693
==> Statistics for epoch 27: 1060 clusters
Epoch: [27][100/100]	Time 0.220 (0.235)	Data 0.000 (0.023)	Loss cc 0.785 (0.744)	Loss ema 5.890 (4.419)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 34.098007678985596
==> Statistics for epoch 28: 1071 clusters
Epoch: [28][100/100]	Time 0.284 (0.276)	Data 0.000 (0.024)	Loss cc 1.792 (0.768)	Loss ema 7.432 (4.482)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 33.202407360076904
==> Statistics for epoch 29: 1052 clusters
Epoch: [29][100/100]	Time 0.201 (0.236)	Data 0.000 (0.024)	Loss cc 1.174 (0.804)	Loss ema 6.095 (4.490)
Mean AP: 39.1%
Mean AP: 39.7%

 * Finished epoch  29  model mAP: 39.1%  model_ema mAP: 39.7%  best: 39.7% *

==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 35.95131778717041
==> Statistics for epoch 30: 1057 clusters
Epoch: [30][100/100]	Time 0.232 (0.229)	Data 0.000 (0.023)	Loss cc 1.286 (0.772)	Loss ema 5.912 (4.458)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 31.301133394241333
==> Statistics for epoch 31: 1081 clusters
Epoch: [31][100/100]	Time 0.210 (0.237)	Data 0.000 (0.026)	Loss cc 1.078 (0.749)	Loss ema 5.985 (4.363)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 30.889663696289062
==> Statistics for epoch 32: 1070 clusters
Epoch: [32][100/100]	Time 0.204 (0.237)	Data 0.000 (0.025)	Loss cc 0.926 (0.750)	Loss ema 6.099 (4.374)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 35.51577711105347
==> Statistics for epoch 33: 1073 clusters
Epoch: [33][100/100]	Time 0.182 (0.238)	Data 0.000 (0.024)	Loss cc 1.423 (0.741)	Loss ema 6.675 (4.328)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 31.05739951133728
==> Statistics for epoch 34: 1085 clusters
Epoch: [34][100/100]	Time 0.290 (0.234)	Data 0.000 (0.023)	Loss cc 0.752 (0.714)	Loss ema 5.643 (4.256)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 34.79663348197937
==> Statistics for epoch 35: 1078 clusters
Epoch: [35][100/100]	Time 0.246 (0.236)	Data 0.000 (0.023)	Loss cc 1.187 (0.721)	Loss ema 6.409 (4.266)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 31.057886600494385
==> Statistics for epoch 36: 1088 clusters
Epoch: [36][100/100]	Time 0.218 (0.237)	Data 0.000 (0.023)	Loss cc 1.384 (0.694)	Loss ema 6.568 (4.206)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 32.42032790184021
==> Statistics for epoch 37: 1079 clusters
Epoch: [37][100/100]	Time 0.195 (0.242)	Data 0.000 (0.027)	Loss cc 1.187 (0.697)	Loss ema 6.077 (4.208)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 31.54980707168579
==> Statistics for epoch 38: 1087 clusters
Epoch: [38][100/100]	Time 0.206 (0.240)	Data 0.000 (0.026)	Loss cc 2.101 (0.715)	Loss ema 7.526 (4.207)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 31.102158546447754
==> Statistics for epoch 39: 1078 clusters
Epoch: [39][100/100]	Time 0.177 (0.233)	Data 0.000 (0.023)	Loss cc 1.208 (0.710)	Loss ema 5.748 (4.142)
Mean AP: 39.8%
Mean AP: 40.4%

 * Finished epoch  39  model mAP: 39.8%  model_ema mAP: 40.4%  best: 40.4% *

==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 35.708953619003296
==> Statistics for epoch 40: 1089 clusters
Epoch: [40][100/100]	Time 0.256 (0.234)	Data 0.000 (0.024)	Loss cc 1.042 (0.693)	Loss ema 6.169 (4.106)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 34.052595138549805
==> Statistics for epoch 41: 1097 clusters
Epoch: [41][100/100]	Time 0.202 (0.238)	Data 0.000 (0.028)	Loss cc 1.789 (0.665)	Loss ema 7.550 (4.057)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 31.422945261001587
==> Statistics for epoch 42: 1085 clusters
Epoch: [42][100/100]	Time 0.231 (0.233)	Data 0.000 (0.023)	Loss cc 1.088 (0.671)	Loss ema 5.795 (4.054)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 31.35746955871582
==> Statistics for epoch 43: 1101 clusters
Epoch: [43][100/100]	Time 0.214 (0.238)	Data 0.000 (0.024)	Loss cc 1.000 (0.662)	Loss ema 6.077 (4.062)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 30.84910559654236
==> Statistics for epoch 44: 1101 clusters
Epoch: [44][100/100]	Time 0.213 (0.231)	Data 0.000 (0.024)	Loss cc 1.376 (0.682)	Loss ema 6.694 (4.043)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 35.76582384109497
==> Statistics for epoch 45: 1094 clusters
Epoch: [45][100/100]	Time 0.207 (0.237)	Data 0.000 (0.024)	Loss cc 1.287 (0.670)	Loss ema 6.895 (4.026)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 30.5348379611969
==> Statistics for epoch 46: 1085 clusters
Epoch: [46][100/100]	Time 0.204 (0.237)	Data 0.000 (0.024)	Loss cc 1.475 (0.685)	Loss ema 6.510 (4.085)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 30.850488424301147
==> Statistics for epoch 47: 1086 clusters
Epoch: [47][100/100]	Time 0.266 (0.236)	Data 0.000 (0.023)	Loss cc 1.094 (0.672)	Loss ema 6.240 (4.020)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 35.656495094299316
==> Statistics for epoch 48: 1094 clusters
Epoch: [48][100/100]	Time 0.211 (0.236)	Data 0.000 (0.026)	Loss cc 1.296 (0.676)	Loss ema 6.187 (4.053)
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 30.407030820846558
==> Statistics for epoch 49: 1091 clusters
Epoch: [49][100/100]	Time 0.203 (0.234)	Data 0.000 (0.024)	Loss cc 1.103 (0.645)	Loss ema 5.961 (4.004)
Mean AP: 40.0%
Mean AP: 40.7%

 * Finished epoch  49  model mAP: 40.0%  model_ema mAP: 40.7%  best: 40.7% *

==> Test with the best model:
=> Loaded checkpoint '../logs/msmt17/v3/model_best_stage2.pth.tar'
Mean AP: 40.7%
CMC Scores:
  top-1          69.4%
  top-5          79.5%
  top-10         83.0%
Total running time:  2:06:16.369204
